<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>robotito firmware</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Functions">Functions</a></li>
<li><a href="#Fields">Fields</a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/robot.html">robot</a></li>
  <li><a href="../modules/omni.html">omni</a></li>
  <li><a href="../modules/color.html">color</a></li>
  <li><a href="../modules/proximity.html">proximity</a></li>
  <li><strong>laser_ring</strong></li>
  <li><a href="../modules/led_ring.html">led_ring</a></li>
  <li><a href="../modules/cb_list.html">cb_list</a></li>
  <li><a href="../modules/wifi_net.html">wifi_net</a></li>
</ul>
<h2>State Machines</h2>
<ul class="nowrap">
  <li><a href="../state machines/test.lua.html">test.lua</a></li>
  <li><a href="../state machines/onoff.lua.html">onoff.lua</a></li>
  <li><a href="../state machines/colorway.lua.html">colorway.lua</a></li>
</ul>
<h2>Scripts</h2>
<ul class="nowrap">
  <li><a href="../scripts/autorun.html">autorun</a></li>
  <li><a href="../scripts/main_ahsm.html">main_ahsm</a></li>
</ul>
<h2>Topics</h2>
<ul class="">
  <li><a href="../topics/README.md.html">README</a></li>
  <li><a href="../topics/nvs_parameters.md.html">nvs_parameters</a></li>
</ul>
<h2>Examples</h2>
<ul class="nowrap">
  <li><a href="../examples/test_color.lua.html">test_color.lua</a></li>
  <li><a href="../examples/test_proximity.lua.html">test_proximity.lua</a></li>
  <li><a href="../examples/test_laser_ring.lua.html">test_laser_ring.lua</a></li>
  <li><a href="../examples/test_led_ring.lua.html">test_led_ring.lua</a></li>
  <li><a href="../examples/test_wifi.lua.html">test_wifi.lua</a></li>
  <li><a href="../examples/test_omni.lua.html">test_omni.lua</a></li>
  <li><a href="../examples/test_ahsm.lua.html">test_ahsm.lua</a></li>
  <li><a href="../examples/calibrate_color.lua.html">calibrate_color.lua</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>laser_ring</code></h1>
<p>Range sensor ring module.</p>
<p>

<p> Configuration is loaded using <code>nvs.read(&quot;laser&quot;, parameter)</code> calls, where the
 available parameters are:  </p>

<ul>
    <li><code>&quot;time_budget&quot;</code> The timing budget for the measurements, defaults to 5000.</li>
</ul>
</p>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#get_reading_cb">get_reading_cb ()</a></td>
	<td class="summary">Factory for a linear range callback.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#get_filtering_cb">get_filtering_cb ()</a></td>
	<td class="summary">Factory for a filtering range callback.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#enable">enable (on[, period=100])</a></td>
	<td class="summary">Enables the range monitoring callback.</td>
	</tr>
</table>
<h2><a href="#Fields">Fields</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#sensor_angles">sensor_angles</a></td>
	<td class="summary">Sensor angles.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#dmin">dmin</a></td>
	<td class="summary">Minimum range for normalization in mm.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#dmax">dmax</a></td>
	<td class="summary">Maximum range for normalization in mm.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#raw_d">raw_d</a></td>
	<td class="summary">The last reading, in raw form.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#norm_d">norm_d</a></td>
	<td class="summary">The last reading, normalized.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#previous_d">previous_d</a></td>
	<td class="summary">The previous reading, normalized.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#cb">cb</a></td>
	<td class="summary">The callback module for the range sensor ring.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Functions"></a>Functions</h2>

    <dl class="function">
    <dt>
    <a name = "get_reading_cb"></a>
    <strong>get_reading_cb ()</strong>
    </dt>
    <dd>
    Factory for a linear range callback.
 The output is written to <a href="../modules/laser_ring.html#norm_d">norm_d</a> and <a href="../modules/laser_ring.html#raw_d">raw_d</a>






    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">local</span> laser=<span class="global">require</span>(<span class="string">'laser_ring'</span>)
laser.cb.append(laser.get_reading_cb())
laser.cb.append(<span class="global">print</span>)
laser.enable(<span class="keyword">true</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "get_filtering_cb"></a>
    <strong>get_filtering_cb ()</strong>
    </dt>
    <dd>
    Factory for a filtering range callback.
 The output is written to <a href="../modules/laser_ring.html#norm_d">norm_d</a> and <a href="../modules/laser_ring.html#raw_d">raw_d</a>






    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">local</span> laser=<span class="global">require</span>(<span class="string">'laser_ring'</span>)
laser.cb.append(laser.get_filtering_cb())
laser.cb.append(<span class="global">print</span>)
laser.enable(<span class="keyword">true</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "enable"></a>
    <strong>enable (on[, period=100])</strong>
    </dt>
    <dd>
    Enables the range monitoring callback. <br/>
 When enabled <a href="../modules/laser_ring.html#cb">cb</a> will be triggered periodically.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">on</span>
            <span class="types"><span class="type">boolean</span></span>
         true value to enable, false value to disable.
        </li>
        <li><span class="parameter">period</span>
            <span class="types"><span class="type">integer</span></span>
         Sampling period in ms, if omitted is read
 from <code>nvs.read(&quot;laser&quot;,&quot;period&quot;)</code>
         (<em>default</em> 100)
        </li>
    </ul>





</dd>
</dl>
    <h2 class="section-header "><a name="Fields"></a>Fields</h2>

    <dl class="function">
    <dt>
    <a name = "sensor_angles"></a>
    <strong>sensor_angles</strong>
    </dt>
    <dd>
    Sensor angles.
 The angles at which each sensor point. It's and array indexed by the
 sensor number 1..6 --FIXME







</dd>
    <dt>
    <a name = "dmin"></a>
    <strong>dmin</strong>
    </dt>
    <dd>
    Minimum range for normalization in mm.  (See <a href="../modules/laser_ring.html#norm_d">norm_d</a>). Initialized from
 <code>nvs.read(&quot;laser&quot;,&quot;dmin&quot;)</code>.


    <ul>
        <li><span class="parameter">dmin</span>
            <span class="types"><span class="type">integer</span></span>



         (<em>default</em> 80)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "dmax"></a>
    <strong>dmax</strong>
    </dt>
    <dd>
    Maximum range for normalization in mm.  (See <a href="../modules/laser_ring.html#norm_d">norm_d</a>). Initialized from
 <code>nvs.read(&quot;laser&quot;,&quot;dmax&quot;)</code>.


    <ul>
        <li><span class="parameter">dmax</span>
            <span class="types"><span class="type">integer</span></span>



         (<em>default</em> 600)
        </li>
    </ul>





</dd>
    <dt>
    <a name = "raw_d"></a>
    <strong>raw_d</strong>
    </dt>
    <dd>
    The last reading, in raw form.
 It's an array with length 6, with measures in mm. This is not affected
 by the <a href="../modules/laser_ring.html#dmin">dmin</a> and <a href="../modules/laser_ring.html#dmax">dmax</a> settings.







</dd>
    <dt>
    <a name = "norm_d"></a>
    <strong>norm_d</strong>
    </dt>
    <dd>
    The last reading, normalized.
 It's an array with length 6. The distances are normalized to 0.0..100.0
 in the <a href="../modules/laser_ring.html#dmin">dmin</a>..<a href="../modules/laser_ring.html#dmax">dmax</a> range, and clipped to 0 or 100 when outside this
 range. For these values to
 be upgdated, you must register and enable a callback (see <a href="../modules/laser_ring.html#get_reading_cb">get_reading_cb</a>
 and <a href="../modules/laser_ring.html#get_filtering_cb">get_filtering_cb</a>).







</dd>
    <dt>
    <a name = "previous_d"></a>
    <strong>previous_d</strong>
    </dt>
    <dd>
    The previous reading, normalized.
 It's a copy of <a href="../modules/laser_ring.html#norm_d">norm_d</a> from previous cycle.







</dd>
    <dt>
    <a name = "cb"></a>
    <strong>cb</strong>
    </dt>
    <dd>
    The callback module for the range sensor ring.
 This is a callback list attached to the range sensor, see <a href="../modules/cb_list.html#">cb_list</a>.







</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2019-01-13 22:13:04 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
